<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Moma's Divine Birthday Portal âœ¨ðŸŽ‚</title>
  <style>
    :root{
      --bg:#06040f;
      --accent:#ff7efc;
      --accent2:#7ad7ff;
      --muted:#a7b0c9;
    }
    html,body{margin:0;padding:0;background:radial-gradient(circle at 50% 10%,#2c1a45,#0b0718 70%);color:#fff;font-family:Inter,system-ui;
      overflow-x:hidden;}

    .halo-bg{
      position:fixed;inset:0;pointer-events:none;z-index:-1;
      background:radial-gradient(circle at 50% 50%,rgba(255,126,252,0.15),transparent 60%),
                  radial-gradient(circle at 20% 80%,rgba(122,215,255,0.15),transparent 70%);
      animation:halopulse 8s infinite alternate;
    }
    @keyframes halopulse{from{filter:blur(40px)}to{filter:blur(70px)}}

    header{text-align:center;padding:40px 20px}
    h1{font-size:clamp(28px,5vw,56px);margin:0;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;color:transparent;filter:drop-shadow(0 0 22px rgba(255,126,252,0.4));animation:glow 3s ease-in-out infinite alternate}
    @keyframes glow{to{filter:drop-shadow(0 0 40px rgba(122,215,255,0.6))}}

    .subtitle{text-align:center;margin-top:6px;color:var(--muted);font-size:18px}

    /* Typewriter */
    #typewriter{width:90%;max-width:820px;margin:26px auto;text-align:center;font-size:22px;color:#fff;min-height:60px}

    /* scanner + main card */
    .container{max-width:1100px;margin:0 auto;padding:20px;display:grid;grid-template-columns:1fr 360px;gap:20px}
    @media(max-width:900px){.container{grid-template-columns:1fr}}

    .scanner, .side{background:rgba(255,255,255,0.05);backdrop-filter:blur(8px);padding:18px;border-radius:16px;box-shadow:0 0 40px rgba(255,126,252,0.08)}

    .cam{aspect-ratio:16/9;background:#000;border-radius:12px;overflow:hidden;position:relative}
    video{width:100%;height:100%;object-fit:cover;transform:scaleX(-1)}

    /* scanner glow */
    .scan-circle{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:260px;height:260px;border-radius:50%;border:4px dashed rgba(255,255,255,0.1);box-shadow:0 0 40px rgba(255,126,252,0.4) inset;animation:rot 6s linear infinite}
    @keyframes rot{to{transform:translate(-50%,-50%) rotate(360deg)}}

    .status{text-align:center;margin-top:12px;font-weight:600}

    button{cursor:pointer;border:none;padding:10px 14px;border-radius:10px;font-weight:600;font-size:15px}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#111}
    .ghost{background:rgba(255,255,255,0.08);color:#fff}

    /* cake */
    .cake{width:220px;height:180px;position:relative;margin:auto;margin-top:10px}
    .plate{position:absolute;left:50%;transform:translateX(-50%);bottom:0;width:240px;height:18px;background:linear-gradient(90deg,#fafcff,#c8d0e1);border-radius:50%}
    .layer{position:absolute;left:50%;transform:translateX(-50%);border-radius:12px}
    .layer.btm{bottom:26px;width:220px;height:90px;background:linear-gradient(180deg,#ffb0d7,#ff6fc7)}
    .layer.top{bottom:86px;width:160px;height:60px;background:linear-gradient(180deg,#ffeeff,#ffb0d7)}
    .flame{width:16px;height:20px;background:radial-gradient(circle at 40% 35%,#fff8d2 0%,#ffd36e 30%,#ff7a3d 70%);border-radius:50%;box-shadow:0 0 20px rgba(255,120,60,0.9);margin:auto;animation:flicker .25s infinite alternate ease-in-out}
    @keyframes flicker{to{transform:translateY(-3px) scale(1.05)}}

    /* divine aura */
    .aura{position:absolute;inset:0;margin:auto;width:260px;height:260px;border-radius:50%;background:radial-gradient(circle,rgba(255,126,252,0.2),transparent 70%);z-index:-1;filter:blur(30px);animation:auraPulse 5s infinite alternate}
    @keyframes auraPulse{to{opacity:0.4;filter:blur(45px)}}

    /* popup */
    .popup{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:.4s}
    .popup.show{opacity:1;pointer-events:auto}
    .popup-card{background:linear-gradient(180deg,#fff,#ffe6ff);color:#111;padding:30px;border-radius:18px;max-width:520px;text-align:center;box-shadow:0 0 40px rgba(255,126,252,0.4)}
    .popup-card h2{margin-top:0}

    /* fireworks canvas */
    #fireworks{position:fixed;left:0;top:0;pointer-events:none;z-index:999}

    footer{text-align:center;margin:40px 0;color:var(--muted)}
  </style>
</head>
<body>
  <div class="halo-bg"></div>
  <header>
    <h1>âœ¨ Happy Birthday, Moma âœ¨</h1>
    <div class="subtitle">A celebration so legendary even the universe pauses to applaud.</div>
  </header>

  <div id="typewriter"></div>

  <div class="container">
    <section class="scanner">
      <div class="cam">
        <video id="video" autoplay muted playsinline></video>
        <div class="scan-circle"></div>
        <div class="aura"></div>
      </div>
      <div class="status" id="status">Starting camera...</div>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button id="force" class="btn">Force Celebrate</button>
        <button id="snap" class="ghost">Snapshot</button>
      </div>
    </section>

    <aside class="side">
      <div class="cake">
        <div class="plate"></div>
        <div class="layer btm"></div>
        <div class="layer top"></div>
        <div style="position:absolute;left:50%;transform:translateX(-50%);bottom:142px;display:flex;gap:12px">
          <div class="flame"></div>
          <div class="flame"></div>
          <div class="flame"></div>
        </div>
      </div>
      <div style="text-align:center;margin-top:10px;font-size:18px">Make a wish, Moma âœ¨</div>
      <div style="margin-top:20px;display:flex;flex-direction:column;gap:10px">
        <button id="ecard" class="btn">Download Birthday Eâ€‘Card</button>
        <button id="mute" class="ghost">Mute / Unmute Music</button>
      </div>
    </aside>
  </div>

  <canvas id="fireworks"></canvas>

  <div id="popup" class="popup">
    <div class="popup-card">
      <h2>WOW!!! ITâ€™S YOUR BIRTHDAY, MOMA! ðŸŽ‰</h2>
      <p>You have unlocked divine-level celebrations. Enjoy the cosmic fireworks!</p>
      <button class="btn" id="closePopup">Letâ€™s Go!</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <script>
    const MODEL_URL='https://justadudewhohacks.github.io/face-api.js/models';
    const video=document.getElementById('video');
    const status=document.getElementById('status');
    const popup=document.getElementById('popup');
    let celebrating=false, audio, muted=false;

    // typewriter
    const tw="Moma, today the universe aligns just to celebrate YOU. âœ¨";
    let ti=0; function typeLoop(){if(ti<tw.length){document.getElementById('typewriter').textContent+=tw[ti++];setTimeout(typeLoop,50);} }
    typeLoop();

    async function loadModels(){
      status.textContent='Loading magic...';
      await faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL);
      startCam();
    }

    async function startCam(){
      try{
        const s = await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}});
        video.srcObject=s;
        video.onloadedmetadata=()=>video.play();
        detect();
        status.textContent='Looking for a beautiful face...';
      }catch(e){status.textContent='Camera unavailable â€” press celebrate!';}
    }

    async function detect(){
      const opt=new faceapi.TinyFaceDetectorOptions({inputSize:256,scoreThreshold:0.5});
      while(true){
        if(video.readyState>=2){
          const d=await faceapi.detectAllFaces(video,opt);
          if(d.length>0&&!celebrating){trigger();}
        }
        await new Promise(r=>setTimeout(r,300));
      }
    }

    function trigger(){
      celebrating=true;
      popup.classList.add('show');
      startFireworks();
      playMusic();
    }

    document.getElementById('closePopup').onclick=()=>popup.classList.remove('show');
    document.getElementById('force').onclick=trigger;

    // music
    function playMusic(){if(muted)return; audio=new Audio('Foram.mp3'); audio.loop=true; audio.play().catch(()=>{});}    
    document.getElementById('mute').onclick=()=>{muted=!muted; if(muted&&audio)audio.pause(); else if(!muted)playMusic();};

    // fireworks
    function startFireworks(){
      const c=document.getElementById('fireworks');
      const ctx=c.getContext('2d');
      c.width=innerWidth; c.height=innerHeight;
      const parts=[];
      function boom(x,y){for(let i=0;i<40;i++){parts.push({x,y,vx:(Math.random()-0.5)*6,vy:(Math.random()-0.5)*6,life:60,color:`hsl(${Math.random()*360},100%,70%)`});}}
      setInterval(()=>boom(Math.random()*innerWidth,Math.random()*innerHeight*0.6),700);
      function frame(){ctx.clearRect(0,0,c.width,c.height); parts.forEach(p=>{p.x+=p.vx; p.y+=p.vy; p.life--; ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,4,4);}); for(let i=parts.length-1;i>=0;i--){if(parts[i].life<=0)parts.splice(i,1);} requestAnimationFrame(frame);} frame();
    }

    loadModels();
  </script>

  <footer>Made with cosmic-level love for Moma âœ¨</footer>
</body>
</html>
